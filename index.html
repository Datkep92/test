<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Milano 259 - Quản lý</title>

  <script>
    const version = Date.now();

    // Load styles.css
    const css = document.createElement("link");
    css.rel = "stylesheet";
    css.href = `./styles.css?v=${version}`;
    document.head.appendChild(css);

    // Load app.js
    const js = document.createElement("script");
    js.src = `./app.js?v=${version}`;
    js.onload = () => {
      // ✅ Chờ 100ms để chắc chắn app.js đã được thực thi
      setTimeout(() => {
        auth.onAuthStateChanged(user => {
          if (user) {
            currentEmployeeId = user.uid;
            document.getElementById("login-page").style.display = "none";
            document.getElementById("main-page").style.display = "block";
            openTabBubble('revenue-expense');
            loadFirebaseData();
          } else {
            document.getElementById("login-page").style.display = "flex";
            document.getElementById("main-page").style.display = "none";
          }
        });
      }, 100);
    };
    document.head.appendChild(js);
  </script>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyDmFpKa8TpDjo3pQADaTubgVpDPOi-FPXk",
      authDomain: "quanly-d7e54.firebaseapp.com",
      databaseURL: "https://quanly-d7e54-default-rtdb.firebaseio.com",
      projectId: "quanly-d7e54",
      storageBucket: "quanly-d7e54.firebasestorage.app",
      messagingSenderId: "482686011267",
      appId: "1:482686011267:web:f2fe9d400fe618487a98b6"
    };
    firebase.initializeApp(firebaseConfig);
    var auth = firebase.auth();
    var db = firebase.database();
  </script>
</head>
<body>
  <!-- Đăng nhập -->
  <div id="login-page" class="center-screen">
    <h2>Đăng Nhập</h2>
    <input type="email" id="email" placeholder="Email" />
    <input type="password" id="password" placeholder="Mật khẩu" />
    <button onclick="login()">Đăng Nhập</button>
  </div>

  <!-- Trang chính -->
  <div id="main-page" style="display:none;">
    <header class="app-header">
      <h1>Milano 259</h1>
      <button onclick="logout()" class="logout-btn">Đăng Xuất</button>
    </header>

    <main class="tab-content-wrapper">
      <!-- Các tab như cũ -->
      <!-- ... giữ nguyên phần Thu Chi, Kho, Cá nhân, Báo cáo, Nhân viên, Chat ... -->
    </main>

    <!-- Floating Menu -->
    <div class="floating-menu">
      <button id="main-float-btn" onclick="toggleMenu()">☰</button>
      <div id="float-options" class="float-options">
        <button onclick="openTabBubble('revenue-expense')">Thu Chi</button>
        <button onclick="openTabBubble('inventory')">Kho</button>
        <button onclick="openTabBubble('profile')">Cá nhân</button>
        <button onclick="openTabBubble('business-report')">Báo cáo</button>
        <button onclick="openTabBubble('employee-management')">Nhân viên</button>
        <button onclick="openTabBubble('chat-section')">Chat</button>
      </div>
    </div>
  </div>
</body>
</html>
