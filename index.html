<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quản lý Kinh doanh</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
    .nav { display: flex; justify-content: space-between; align-items: center; background: #f4f4f4; padding: 10px; }
    .nav a { color: #000; text-decoration: none; }
    .section { margin: 20px 0; }
    .section h2 { border-bottom: 1px solid #ccc; padding-bottom: 5px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    table, th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background: #f4f4f4; }
    button { padding: 5px 10px; cursor: pointer; background: #4CAF50; color: white; border: none; }
    button:hover { background: #45a049; }
    .summary p { margin: 5px 0; }
    .filter { margin: 10px 0; }
  </style>
  <!-- Thêm SDK Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js"></script>
  <script>
    // Cấu hình Firebase (thay bằng cấu hình thực từ Firebase Console)
   const firebaseConfig = {
  apiKey: "AIzaSyDmFpKa8TpDjo3pQADaTubgVpDPOi-FPXk",
  authDomain: "quanly-d7e54.firebaseapp.com",
  databaseURL: "https://quanly-d7e54-default-rtdb.asia-southeast1.firebasedatabase.app", // Đảm bảo không có dấu / ở cuối
  projectId: "quanly-d7e54",
  storageBucket: "quanly-d7e54.appspot.com",
  messagingSenderId: "482686011267",
  appId: "1:482686011267:web:f2fe9d400fe618487a98b6",
  measurementId: "G-G3H6MTCWCM"
};

    // Khởi tạo Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Hàm thêm chi phí
    function addExpense() {
      const description = prompt("Nhập mô tả chi phí:");
      const amount = prompt("Nhập số tiền (₫):");
      if (description && amount) {
        database.ref('expenses').push({
          description: description,
          amount: parseInt(amount),
          timestamp: firebase.database.ServerValue.TIMESTAMP
        }).then(() => {
          alert("Thêm chi phí thành công!");
          updateSummary();
        }).catch((error) => {
          alert("Lỗi: " + error.message);
        });
      }
    }

    // Hàm thêm xuất hàng
    function addShipment() {
      const product = prompt("Nhập sản phẩm:");
      const quantity = prompt("Nhập số lượng:");
      const unit = prompt("Nhập đơn vị tính:");
      if (product && quantity && unit) {
        database.ref('shipments').push({
          product: product,
          quantity: parseInt(quantity),
          unit: unit,
          timestamp: firebase.database.ServerValue.TIMESTAMP
        }).then(() => {
          alert("Thêm xuất hàng thành công!");
          loadShipments();
        }).catch((error) => {
          alert("Lỗi: " + error.message);
        });
      }
    }

    // Hàm thêm doanh thu
    function addRevenue() {
      const description = prompt("Nhập mô tả doanh thu:");
      const amount = prompt("Nhập số tiền (₫):");
      if (description && amount) {
        database.ref('revenues').push({
          description: description,
          amount: parseInt(amount),
          timestamp: firebase.database.ServerValue.TIMESTAMP
        }).then(() => {
          alert("Thêm doanh thu thành công!");
          updateSummary();
        }).catch((error) => {
          alert("Lỗi: " + error.message);
        });
      }
    }

    // Hàm thêm sản phẩm vào kho
    function addProduct() {
      const name = prompt("Nhập tên sản phẩm:");
      const quantity = prompt("Nhập số lượng:");
      const unit = prompt("Nhập đơn vị tính:");
      const price = prompt("Nhập giá đơn vị (₫):");
      if (name && quantity && unit && price) {
        database.ref('inventory').push({
          name: name,
          quantity: parseInt(quantity),
          unit: unit,
          price: parseInt(price),
          timestamp: firebase.database.ServerValue.TIMESTAMP
        }).then(() => {
          alert("Thêm sản phẩm thành công!");
          loadInventory();
        }).catch((error) => {
          alert("Lỗi: " + error.message);
        });
      }
    }

    // Hàm thêm người dùng
    function addUser() {
      const username = prompt("Nhập tên đăng nhập:");
      const role = prompt("Nhập vai trò (Nhân viên/Quản lý):");
      const status = prompt("Nhập trạng thái (Hoạt động/Không hoạt động):");
      if (username && role && status) {
        database.ref('users').push({
          username: username,
          role: role,
          status: status,
          timestamp: firebase.database.ServerValue.TIMESTAMP
        }).then(() => {
          alert("Thêm người dùng thành công!");
          loadUsers();
        }).catch((error) => {
          alert("Lỗi: " + error.message);
        });
      }
    }

    // Hàm tải và hiển thị xuất hàng
    function loadShipments() {
      database.ref('shipments').on('value', (snapshot) => {
        const shipmentsTable = document.querySelector('#shipmentsTable tbody');
        shipmentsTable.innerHTML = '';
        snapshot.forEach((childSnapshot) => {
          const data = childSnapshot.val();
          const row = document.createElement('tr');
          row.innerHTML = `<td>${data.product}</td><td>${data.quantity}</td><td>${data.unit}</td><td>Xóa</td>`;
          shipmentsTable.appendChild(row);
        });
      });
    }

    // Hàm tải và hiển thị kho hàng
    function loadInventory() {
      database.ref('inventory').on('value', (snapshot) => {
        const inventoryTable = document.querySelector('#inventoryTable tbody');
        inventoryTable.innerHTML = '';
        snapshot.forEach((childSnapshot) => {
          const data = childSnapshot.val();
          const row = document.createElement('tr');
          row.innerHTML = `<td>${data.name}</td><td>${data.quantity}</td><td>${data.unit}</td><td>${data.price}₫</td><td>Xóa</td>`;
          inventoryTable.appendChild(row);
        });
      });
    }

    // Hàm tải và hiển thị người dùng
    function loadUsers() {
      database.ref('users').on('value', (snapshot) => {
        const usersTable = document.querySelector('#usersTable tbody');
        usersTable.innerHTML = '';
        snapshot.forEach((childSnapshot) => {
          const data = childSnapshot.val();
          const row = document.createElement('tr');
          row.innerHTML = `<td>${data.username}</td><td>${data.role}</td><td>${data.status}</td><td>Xóa</td>`;
          usersTable.appendChild(row);
        });
      });
    }

    // Hàm cập nhật tổng kết
    function updateSummary() {
      let totalExpense = 0;
      let totalRevenue = 0;

      database.ref('expenses').once('value').then((snapshot) => {
        snapshot.forEach((childSnapshot) => {
          totalExpense += childSnapshot.val().amount || 0;
        });
        database.ref('revenues').once('value').then((snapshot) => {
          snapshot.forEach((childSnapshot) => {
            totalRevenue += childSnapshot.val().amount || 0;
          });
          const balance = totalRevenue - totalExpense;
          document.querySelector('#revenue').textContent = `Doanh thu: ${totalRevenue}₫`;
          document.querySelector('#expense').textContent = `Tổng chi phí: ${totalExpense}₫`;
          document.querySelector('#balance').textContent = `Số dư: ${balance}₫`;
        });
      });
    }

    // Hàm lưu ghi chú
    function saveNote() {
      const note = prompt("Nhập ghi chú cá nhân:");
      if (note) {
        database.ref('notes').push({
          content: note,
          timestamp: firebase.database.ServerValue.TIMESTAMP
        }).then(() => {
          alert("Lưu ghi chú thành công!");
        }).catch((error) => {
          alert("Lỗi: " + error.message);
        });
      }
    }

    // Gắn sự kiện khi tải trang
    window.onload = () => {
      updateSummary();
      loadShipments();
      loadInventory();
      loadUsers();
      document.querySelector('#addExpenseBtn').addEventListener('click', addExpense);
      document.querySelector('#addShipmentBtn').addEventListener('click', addShipment);
      document.querySelector('#addRevenueBtn').addEventListener('click', addRevenue);
      document.querySelector('#addProductBtn').addEventListener('click', addProduct);
      document.querySelector('#addUserBtn').addEventListener('click', addUser);
      document.querySelector('#saveNoteBtn').addEventListener('click', saveNote);
    };
  </script>
</head>
<body>
  <div class="nav">
    <h1>📊 Quản lý Kinh doanh</h1>
    <a href="#">Đăng xuất</a>
  </div>

  <div class="login-section">
    <h2>🔐 Đăng nhập</h2>
    <input type="text" placeholder="Tên đăng nhập"><br>
    <input type="password" placeholder="Mật khẩu"><br>
    <label><input type="checkbox"> Ghi nhớ đăng nhập</label><br>
    <button>Đăng nhập</button>
    <p>Đang xác thực...</p>
  </div>

  <div class="menu">
    <h2>💸 Chi phí | 📦 Xuất hàng | 💰 Doanh thu</h2>
  </div>

  <div class="section">
    <h2>💸 Chi phí</h2>
    <button id="addExpenseBtn">Thêm chi phí</button>
    <table>
      <thead>
        <tr><th>Mô tả</th><th>Số tiền</th><th>Hành động</th></tr>
      </thead>
      <tbody id="expensesTable"></tbody>
    </table>
  </div>

  <div class="section">
    <h2>📦 Xuất hàng</h2>
    <button id="addShipmentBtn">Thêm xuất hàng</button>
    <table>
      <thead>
        <tr><th>Sản phẩm</th><th>Số lượng</th><th>ĐVT</th><th>Hành động</th></tr>
      </thead>
      <tbody id="shipmentsTable"></tbody>
    </table>
  </div>

  <div class="section">
    <h2>💰 Doanh thu</h2>
    <button id="addRevenueBtn">Thêm doanh thu</button>
    <table>
      <thead>
        <tr><th>Mô tả</th><th>Số tiền</th><th>Hành động</th></tr>
      </thead>
      <tbody id="revenuesTable"></tbody>
    </table>
  </div>

  <div class="section">
    <h2>📝 Tổng kết ngày</h2>
    <p id="revenue">Doanh thu: 0₫</p>
    <p id="expense">Tổng chi phí: 0₫</p>
    <p id="balance">Số dư: 0₫</p>
    <p>📌 Ghi chú cá nhân:</p>
    <button id="saveNoteBtn">💾 Lưu dữ liệu</button>
  </div>

  <div class="section">
    <h2>📦 Quản lý Kho hàng</h2>
    <button id="addProductBtn">➕ Thêm sản phẩm</button>
    <table>
      <thead>
        <tr><th>Tên sản phẩm</th><th>Số lượng</th><th>ĐVT</th><th>Giá đơn vị</th><th>Hành động</th></tr>
      </thead>
      <tbody id="inventoryTable"></tbody>
    </table>
  </div>

  <div class="section">
    <h2>📊 Báo cáo</h2>
    <button>📅 Báo cáo ngày</button>
    <button>📆 Báo cáo tháng</button>
    <button>🖨️ In báo cáo</button>
    <div class="filter">
      <select><option>Tất cả người dùng</option></select>
      <select><option>Tất cả danh mục</option></select>
      <button>🔍 Áp dụng</button>
    </div>
  </div>

  <div class="section">
    <h2>👥 Quản lý Người dùng</h2>
    <select>
      <option>Nhân viên</option>
      <option>Quản lý</option>
    </select>
    <button id="addUserBtn">➕ Thêm người dùng</button>
    <table>
      <thead>
        <tr><th>Tên đăng nhập</th><th>Vai trò</th><th>Trạng thái</th><th>Hành động</th></tr>
      </thead>
      <tbody id="usersTable"></tbody>
    </table>
  </div>
</body>
</html>
